---
layout: post
status: publish
published: true
title: "降级 Mac OS X"
author:
  display_name: Leask
  login: leask
  email: i@leaskh.com
  url: http://www.leaskh.com
author_login: leask
author_email: i@leaskh.com
author_url: http://www.leaskh.com
wordpress_id: 1902
wordpress_url: http://www.leaskh.com/?p=1902
date: '2011-11-18 14:29:06 +0800'
date_gmt: '2011-11-18 06:29:06 +0800'
categories:
- Uncategorized
tags: []
comments: []
---
<p>不知道是现阶段 OS X 10.7.3 beta 1 有 Bug 还是我个人 RP 的问题，玩了两天，千方百计，还是未能解决 MacBook Pro 运行龟速的问题。主要体现在磁盘 IO 缓慢，Finder 和 iTunes 占用 CPU 都很高，多指手势延时超过 1 秒。</p>
<p>忍无可忍，尝试用 10.7.2 的升级包降级回到 10.7.2 稳定版。却提示版本太新，不能安装老版本的 combo 包。立刻想到了跑 Reversioner11C73Client.pkg，结果报错：&ldquo;The volume must contain Mac OS X version 10.7.2 11C73&rdquo;。</p>
<p>解开&nbsp;Reversioner11C73Client.pkg 发现&nbsp;Contents&#47;Resources&#47;VolumeCheck 中有以下检测：</p>
<pre>#!&#47;usr&#47;bin&#47;perl</p>
<p>my $SYSTEM_VERS = "$ARGV[0]"."&#47;System&#47;Library&#47;CoreServices&#47;SystemVersion.plist";<br />
my $SERVER_VERS = "$ARGV[0]"."&#47;System&#47;Library&#47;CoreServices&#47;ServerVersion.plist";<br />
my $EXIT_VALUE = 0;</p>
<p>DO_CHECKS: {<br />
	if(! -e "$SYSTEM_VERS") {<br />
		$EXIT_VALUE = (( 1 << 5 ) | 16 );<br />
		last;<br />
	}</p>
<p>	if(! MatchSystemVersionRange($SYSTEM_VERS, "10.7.2", "11C1", "11C73")) {<br />
		$EXIT_VALUE = (( 1 << 5 ) | 16 );<br />
     	last;<br />
	}</p>
<p>	if((-e $SERVER_VERS)) {<br />
		$EXIT_VALUE = (( 1 << 5 ) | 16 );<br />
		last;<br />
	}<br />
}</p>
<p>exit($EXIT_VALUE);</p>
<p>......<&#47;pre><br />
再观察&nbsp;Contents&#47;Resources&#47;English.lproj&#47;VolumeCheck.strings：</p>
<pre>"16" = "The volume must contain Mac OS X version 10.7.2 11C73";<br />
"17" = "This Downgrader requires that reversioner_flat.tmp be installed on this volume.";<&#47;pre><br />
哈，这不很明显吗？原来安装包仅仅检测 &#47;System&#47;Library&#47;CoreServices&#47;SystemVersion.plist 中的版本号，一旦发现版本号不满足，就不允许往后安装了。那就简单了：</p>
<pre>sudo vim &#47;System&#47;Library&#47;CoreServices&#47;SystemVersion.plist<&#47;pre><br />
直接改为：</p>
<pre><?xml version="1.0" encoding="UTF-8"?><br />
<!DOCTYPE plist PUBLIC "-&#47;&#47;Apple&#47;&#47;DTD PLIST 1.0&#47;&#47;EN" "http:&#47;&#47;www.apple.com&#47;DTDs&#47;PropertyList-1.0.dtd"></p>
<plist version="1.0">
<dict><br />
	<key>ProductBuildVersion<&#47;key><br />
	<string>11C73<&#47;string><br />
	<key>ProductCopyright<&#47;key><br />
	<string>1983-2011 Apple Inc.<&#47;string><br />
	<key>ProductName<&#47;key><br />
	<string>Mac OS X<&#47;string><br />
	<key>ProductUserVisibleVersion<&#47;key><br />
	<string>10.7.2<&#47;string><br />
	<key>ProductVersion<&#47;key><br />
	<string>10.7.2<&#47;string><br />
<&#47;dict><br />
<&#47;plist><&#47;pre><br />
我都不屑跑 Reversioner 了，直接跑 MacOSXUpdCombo10.7.2.pkg 然后重启。<br />
机器闪电搬的速度又回来了，哈！痛快！</p>
