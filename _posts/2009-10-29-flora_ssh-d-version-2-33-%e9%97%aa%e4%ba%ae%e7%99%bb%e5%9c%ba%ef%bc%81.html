---
layout: post
status: publish
published: true
title: Flora_ssh-D Version 2.33 闪亮登场！
author:
  display_name: Leask
  login: leask
  email: i@leaskh.com
  url: http://www.leaskh.com
author_login: leask
author_email: i@leaskh.com
author_url: http://www.leaskh.com
wordpress_id: 54
wordpress_url: http://leaskh.wordpress.com/2009/10/29/flora_ssh-d-version-2-33-%e9%97%aa%e4%ba%ae%e7%99%bb%e5%9c%ba%ef%bc%81
date: '2009-10-29 03:26:29 +0800'
date_gmt: '2009-10-29 03:26:29 +0800'
categories:
- Uncategorized
tags: []
comments:
- id: 356
  author: "上网"
  author_email: ''
  author_url: ''
  date: '2009-10-29 13:10:26 +0800'
  date_gmt: '2009-10-29 13:10:26 +0800'
  content: "希望能开发linux版的Flora_ssh-D"
---
<div id="msgcns!15BAC1A170471DB!15080" class="bvMsg">
<p><img style="border-bottom:0;border-left:0;display:inline;border-top:0;border-right:0;" title="Screen shot 2009-10-29 at 10.10.21 AM" border="0" alt="Screen shot 2009-10-29 at 10.10.21 AM" src="http:&#47;&#47;www.leaskh.com&#47;wp-content&#47;uploads&#47;2010&#47;09&#47;screenshot2009-10-29at10.png?w=300" width="640" height="458" &#47;> <&#47;p>
<p>Flora_ssh-D是什么？<&#47;p>
<ol>
<li>Flora_ssh-D是一个Applescript（以app形式封装），在Mac OS上开发和运行（有计划推出针对Windows的版本）；<&#47;li>
<li>Flora_ssh-D是一个iTunes VoiveOver程序，能够像iPod shuffle那样自动报读当前正在播放的歌名和艺术家；<&#47;li>
<li>Flora_ssh-D能够自动连接ssh -D服务器，自动创建Socks代理服务器，高速访问某些如Twitter、Facebook等国外优秀站点，并在连接断开的时候自动重连，配合ssh -D服务器使用，让Wall从此透明；<&#47;li>
<li>Flora_ssh-D并不包含ssh -D服务器信息，如果你要使用第3条的功能，你需要自己购买ssh -D服务器，<strong>做有责任感的网民，网上行为务必符合国家法律法规<&#47;strong>；<&#47;li>
<li>Flora_ssh-D能自动更新你的Twitter状态为你正在听的歌，如：【I am listening to #Sensible by #Sun Yan-Zi in album #Leave. &#47;&#47; Thursday, October 29, 2009 11:05:32 AM】；<&#47;li>
<li>Flora_ssh-D能自动记录你正在听的歌到Last.fm；<&#47;li>
<li>Flora_ssh-D能自动更新你DNS-O-MATIC上的动态IP地址为你的当前IP；<&#47;li>
<li>Flora_ssh-D能自动判断在线状态，自动为你开启和关闭某些软件；<&#47;li>
<li><strong>推荐把Flora_ssh-D设置为开机启动，只需要在开机的时候执行这一个脚本，其他的程序可以配置到脚本里面，自动根据在线状态为你自动开启和关闭；<&#47;strong><&#47;li>
<li>Flora_ssh-D是开源的自由软件，并已经在Google Code上创建为开源项目：<a href="http:&#47;&#47;code.google.com&#47;p&#47;flora-ssh-d&#47;" target="_blank">http:&#47;&#47;code.google.com&#47;p&#47;flora-ssh-d&#47;<&#47;a><&#47;li><&#47;ol>
<p>Version 2.33有什么新改进？<&#47;p>
<ol>
<li>全新的任务调度，大大缩短iTunes VoiceOver的时间延迟；<&#47;li>
<li>全新的配置方式，现在下载程序后无需配置就能马上执行，比较适合只需要iTunes VoiceOver功能的朋友；<&#47;li>
<li>优化VoiceOver功能，添加音量淡入淡出功能，听起来效果更好，和iPod shuffle上基本上没有分别了；<&#47;li>
<li>完善Twitter功能，自动在Twitter上发布你正在听的歌；<&#47;li>
<li>完善last.fm歌曲记录功能；<&#47;li>
<li>修正ssh -D连接的bug，让ssh -D连接更加顺畅，并在退出程序的时候自动关闭ssh &ndash;D以释放内存；<&#47;li>
<li>进一步减少空闲时的资源占用，让脚本更轻巧，几乎感觉不到脚本的存在；<&#47;li>
<li>全新的任务管理方式，运行更快，更稳定；<&#47;li>
<li>添加中文配置说明，方便英文不好的朋友使用。<&#47;li><&#47;ol>
<p><a title="Flora_ssh-D on Google Code" href="http:&#47;&#47;code.google.com&#47;p&#47;flora-ssh-d&#47;" target="_blank">Flora_ssh-D<&#47;a> 2.33 能够在以下地址下载到：<a title="http:&#47;&#47;code.google.com&#47;p&#47;flora-ssh-d&#47;downloads&#47;list" href="http:&#47;&#47;code.google.com&#47;p&#47;flora-ssh-d&#47;downloads&#47;list" target="_blank">http:&#47;&#47;code.google.com&#47;p&#47;flora-ssh-d&#47;downloads&#47;list<&#47;a><&#47;p>
<p>&nbsp;<&#47;p>
<p>源代码如下：<&#47;p><br />
<blockquote>
<p>(* Flora_ssh-D Version 2.33<br &#47;>Open Source Project Home&#47;开源项目主页: <a href="http:&#47;&#47;code.google.com&#47;p&#47;flora-ssh-d&#47;">http:&#47;&#47;code.google.com&#47;p&#47;flora-ssh-d&#47;<&#47;a><br &#47;>Code by&#47;程序编写: 黄思夏 &#47; Leask Huang<br &#47;>Blog: <a href="http:&#47;&#47;www.leaskh.com">http:&#47;&#47;www.leaskh.com<&#47;a> (天朝访问需翻墙)<br &#47;>E-mail&#47;GTalk&#47;MSN&#47;QQ: i@leaskh.com *)
<p>(* CUSTOM THESE SETTINGS BEFORE YOUR RUN THINS SCRIPT &#47;&#47; 运行此脚本前请先配置此区域的参数<br &#47;>&nbsp;&nbsp;&nbsp; LEAVE IT BLANK IF YOU DON'T NEED IT &#47;&#47; 如你不需要其中某些功能请将设置留空 *)<br &#47;>property SSHServerName : ""<br &#47;>property SSHUserName : ""<br &#47;>property SSHPasswd : ""<br &#47;>property TwitterUsername : ""<br &#47;>property TwitterPassword : ""<br &#47;>property DNSUsername : ""<br &#47;>property DNSPassword : ""<br &#47;>property LastfmUsername : ""<br &#47;>property LastfmPassword : ""<br &#47;>property appStList : &#123;&#125;<br &#47;>property appQuitList : &#123;&#125;
<p>(* Example&#47;示例 &#47;&#47; English Help &#47;&#47; 中文帮助 <br &#47;>property SSHServerName : "ssh.yourdomain.com"&nbsp;&nbsp; -- ssh -D Server Address (or leave it blank)&nbsp; &#47;&#47;&nbsp; ssh -D 翻墙服务器地址 (不使用ssh -D则留空)<br &#47;>property SSHUserName : "*******"&nbsp;&nbsp; -- ssh -D User Name (or leave it blank)&nbsp; &#47;&#47;&nbsp; ssh -D 帐号 (不使用ssh -D则留空)<br &#47;>property SSHPasswd : "*******"&nbsp;&nbsp; -- ssh -D Password (or leave it blank) &#47;&#47;&nbsp; ssh -D 密码 (不使用ssh -D则留空)<br &#47;>property TwitterUsername : "*******"&nbsp;&nbsp; -- Twitter User Name (or leave it blank)&nbsp; &#47;&#47;&nbsp; Twitter帐号 (不使用Twitter则留空)<br &#47;>property TwitterPassword : "*******"&nbsp;&nbsp; -- Twitter Password (or leave it blank)&nbsp; &#47;&#47;&nbsp; Twitter密码 (不使用Twitter则留空)<br &#47;>property DNSUsername : "*******"&nbsp;&nbsp; -- DNS User Name (or leave it blank)&nbsp; &#47;&#47;&nbsp; DNS-O-MATIC动态IP帐号 (不使用动态IP则留空)<br &#47;>property DNSPassword : "*******"&nbsp;&nbsp; -- DNS Password (or leave it blank)&nbsp; &#47;&#47;&nbsp; DNS-O-MATIC动态IP密码 (不使用动态IP则留空)<br &#47;>property LastfmUsername : "*******"&nbsp;&nbsp; -- last.fm User Name (or leave it blank)&nbsp; &#47;&#47; last.fm帐号 (不使用last.fm则留空)<br &#47;>property LastfmPassword : "*******"&nbsp;&nbsp; -- last.fm Password (or leave it blank)&nbsp; &#47;&#47;&nbsp; last.fm密码 (不使用last.fm则留空)<br &#47;>property appStList : &#123;"App 1", "软件2","iChat"&#125;&nbsp;&nbsp; -- these apps will launch while you are online (or leave it blank)&nbsp; &#47;&#47;&nbsp; 填写【在线】时需【开启】的软件(不使用此功能则留空)<br &#47;>property appQuitList : &#123;"App 1", "软件2","QQ"&#125;&nbsp;&nbsp; -- these apps will quit while you are offline (or leave it blank)&nbsp; &#47;&#47;&nbsp; 填写【离线】时需【关闭】的软件(不使用此功能则留空)<br &#47;>*)
<p>(* ======= Variable Declaration ======= *)<br &#47;>global timeTry<br &#47;>global DNSResponse<br &#47;>global isOLast<br &#47;>global iTsCurDBID<br &#47;>global iTsORSoundVolume<br &#47;>global strSNGArtist<br &#47;>global strSNGName<br &#47;>global strSNGAlbum<br &#47;>global strSNGTrackNumber<br &#47;>global strSNGDuration<br &#47;>global intIdleCount
<p>(* ======= Main Script ======= *)<br &#47;>on run<br &#47;>&nbsp;&nbsp;&nbsp; set isOLast to ""<br &#47;>&nbsp;&nbsp;&nbsp; set iTsCurDBID to ""<br &#47;>&nbsp;&nbsp;&nbsp; set intIdleCount to 10<br &#47;>end run
<p>on quit<br &#47;>&nbsp;&nbsp;&nbsp; if isOLast is "online" then fnTwitter("I am offline now! &#47;&#47; " &amp; (current date), true)<br &#47;>&nbsp;&nbsp;&nbsp; fnShellSSHEnd(true)<br &#47;>&nbsp;&nbsp;&nbsp; fnAppQuit()<br &#47;>&nbsp;&nbsp;&nbsp; continue quit<br &#47;>end quit
<p>on idle<br &#47;>&nbsp;&nbsp;&nbsp; if fnCheckNet() is true then<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if intIdleCount > 9 then<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fnSSHCnt()<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if isOLast is not "online" then<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fnAppStart()<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fnDNSUpdate()<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fnTwitter("I am online now! &#47;&#47; " &amp; (current date), true)<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end if<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set intIdleCount to 0<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end if<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fnMusic(true)<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set intIdleCount to intIdleCount + 1<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set isOLast to "online"<br &#47;>&nbsp;&nbsp;&nbsp; else<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fnMusic(false)<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if isOLast is not "offline" then<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fnShellSSHEnd(true)<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fnAppQuit()<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end if<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set isOLast to "offline"<br &#47;>&nbsp;&nbsp;&nbsp; end if<br &#47;>&nbsp;&nbsp;&nbsp; return 33<br &#47;>end idle
<p>(* ======= Functions ======= *)<br &#47;>to fnCheckNet()<br &#47;>&nbsp;&nbsp;&nbsp; try<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; do shell script "curl --connect-timeout 33 "apple.com&#47;favicon.ico<br />
""<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if isOLast is not "online" then SmartSay(&#123;"Online"&#125;)<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return true<br &#47;>&nbsp;&nbsp;&nbsp; on error<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if isOLast is not "offline" then SmartSay(&#123;"Offline"&#125;)<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return false<br &#47;>&nbsp;&nbsp;&nbsp; end try<br &#47;>end fnCheckNet
<p>to fnAppStart()<br &#47;>&nbsp;&nbsp;&nbsp; if (count appStList) > 0 then<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SmartSay(&#123;"Start Apps"&#125;)<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; repeat with intSti from 1 to (count appStList)<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tell application (item intSti of appStList) to activate<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end repeat<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SmartSay(&#123;"OK"&#125;)<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; on error<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SmartSay(&#123;"Failed"&#125;)<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end try<br &#47;>&nbsp;&nbsp;&nbsp; end if<br &#47;>end fnAppStart
<p>to fnAppQuit()<br &#47;>&nbsp;&nbsp;&nbsp; if (count appQuitList) > 0 then<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SmartSay(&#123;"Quit Applications"&#125;)<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; repeat with intSti from 1 to count appQuitList<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tell application (item intSti of appQuitList) to quit<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end repeat<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SmartSay(&#123;"OK"&#125;)<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; on error<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SmartSay(&#123;"Failed"&#125;)<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end try<br &#47;>&nbsp;&nbsp;&nbsp; end if<br &#47;>end fnAppQuit
<p>to fnSSHCnt()<br &#47;>&nbsp;&nbsp;&nbsp; if (length of SSHServerName) > 0 and (length of SSHUserName) > 0 and (length of SSHPasswd) > 0 then<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set timeTry to 0<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; repeat while fnCheckSSHD() is false<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SmartSay(&#123;"Connect SSH D"&#125;)<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if timeTry > 0 then if (button returned of (display dialog "ssh -D connection failed." &amp; return &amp; "" buttons &#123;"Retry", "Ignore"&#125;)) is "Ignore" then exit repeat<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fnShellSSH()<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set timeTry to timeTry + 1<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end repeat<br &#47;>&nbsp;&nbsp;&nbsp; end if<br &#47;>end fnSSHCnt
<p>to fnCheckSSHD()<br &#47;>&nbsp;&nbsp;&nbsp; try<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; do shell script "curl --socks5 127.0.0.1:7070 --connect-timeout 33 "apple.com&#47;favicon.ico""<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if timeTry > 0 then SmartSay(&#123;"OK"&#125;)<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return true<br &#47;>&nbsp;&nbsp;&nbsp; on error<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if timeTry > 0 then SmartSay(&#123;"Failed"&#125;)<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return false<br &#47;>&nbsp;&nbsp;&nbsp; end try<br &#47;>end fnCheckSSHD
<p>to fnShellSSH()<br &#47;>&nbsp;&nbsp;&nbsp; try<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; do shell script "killall Terminal"<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end try<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tell application "Terminal"<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; activate<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fnShellSSHEnd(false) of me<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; delay 1<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; do script "nohup ssh -D 7070 " &amp; SSHUserName &amp; "@" &amp; SSHServerName &amp; " > Downloads&#47;.Flora_ssh-D.out" in window 1<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end tell<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SmartSay(&#123;"SSH D connection request and log in request have been sent. Waiting for response from remote server."&#125;)<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tell application "Terminal"<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; do script SSHPasswd in window 1<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; delay 1<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; quit<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end tell<br &#47;>&nbsp;&nbsp;&nbsp; end try<br &#47;>end fnShellSSH
<p>to fnShellSSHEnd(isSay)<br &#47;>&nbsp;&nbsp;&nbsp; if (length of SSHServerName) > 0 and (length of SSHUserName) > 0 and (length of SSHPasswd) > 0 then<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if isSay is true then SmartSay(&#123;"Disconnect SSH D"&#125;)<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; do shell script "killall ssh"<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; do shell script "killall ssh-agent"<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; do shell script "rm ~&#47;Downloads&#47;.Flora_ssh-D.out"<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end try<br &#47;>&nbsp;&nbsp;&nbsp; end if<br &#47;>end fnShellSSHEnd
<p>to fnTwitter(strTwText, isSay)<br &#47;>&nbsp;&nbsp;&nbsp; if (length of TwitterUsername) > 0 and (length of TwitterPassword) > 0 and (length of strTwText) > 0 then<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (length of strTwText) > 140 then<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set strTwText to (characters 1 through 137 of strTwText as string) &amp; "..."<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end if<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if isSay is true then SmartSay(&#123;"Update Twitter state"&#125;)<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; do shell script "curl --connect-timeout 33&nbsp; --user " &amp; (quoted form of (TwitterUsername &amp; ":" &amp; TwitterPassword)) &amp; " --data-binary " &amp; (quoted form of ("status=" &amp; strTwText)) &amp; " "<a href="https:&#47;&#47;twitter.com&#47;statuses&#47;update.json""">https:&#47;&#47;twitter.com&#47;statuses&#47;update.json""<&#47;a><br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if isSay is true then SmartSay(&#123;"OK"&#125;)<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; on error<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if isSay is true then<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SmartSay(&#123;"Failed"&#125;)<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SmartSay(&#123;"Update Twitter state failed"&#125;)<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end if<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end try<br &#47;>&nbsp;&nbsp;&nbsp; end if<br &#47;>end fnTwitter
<p>to fnDNSShell()<br &#47;>&nbsp;&nbsp;&nbsp; try<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set DNSResponse to (do shell script "curl --connect-timeout 33 "<a href="https:&#47;&#47;"">https:&#47;&#47;"<&#47;a> &amp; DNSUsername &amp; ":" &amp; DNSPassword &amp; "@updates.dnsomatic.com&#47;nic&#47;update?&amp;wildcard=NOCHG&amp;mx=NOCHG&amp;backmx=NOCHG"")<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if first word of DNSResponse is "good" then -- (second word of DNSResponse) is IP address<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return true<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return false<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end if<br &#47;>&nbsp;&nbsp;&nbsp; on error<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return false<br &#47;>&nbsp;&nbsp;&nbsp; end try<br &#47;>end fnDNSShell
<p>to fnDNSUpdate()<br &#47;>&nbsp;&nbsp;&nbsp; if (length of DNSUsername) > 0 and (length of DNSPassword) > 0 then<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SmartSay(&#123;"Update dynamic IP"&#125;)<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if fnDNSShell() is true then<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SmartSay(&#123;"OK"&#125;)<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SmartSay(&#123;"Failed"&#125;)<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end if<br &#47;>&nbsp;&nbsp;&nbsp; end if<br &#47;>end fnDNSUpdate
<p>to fnURLec(strToUEC)<br &#47;>&nbsp;&nbsp;&nbsp; return do shell script "python -c 'import sys, urllib; print urllib.quote(sys.argv[1])' "" &amp; strToUEC &amp; """<br &#47;>end fnURLec
<p>to fniTunesisActive()<br &#47;>&nbsp;&nbsp;&nbsp; tell application "System Events" to return (name of processes contains "iTunes")<br &#47;>end fniTunesisActive
<p>to fuisiTunesNUD()<br &#47;>&nbsp;&nbsp;&nbsp; if fniTunesisActive() is true then<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tell application "iTunes"<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if player state is playing then<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set iTsNewDBID to (get database ID of current track)<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if iTsNewDBID is not iTsCurDBID then<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set strSNGArtist to (get artist of current track)<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set strSNGName to (get name of current track)<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set strSNGAlbum to (get album of current track)<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set strSNGTrackNumber to (get track number of current track)<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set strSNGDuration to (get duration of current track as integer)<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set iTsCurDBID to iTsNewDBID<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return true<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br &#47;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>
