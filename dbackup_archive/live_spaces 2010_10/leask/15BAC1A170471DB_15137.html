<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><link rel="stylesheet" type="text/css" href="style.css" /><title>&#25171;&#36896;&#33258;&#21160;&#32763;&#22681;&#30340;iPod touch or iPhone&#65281;</title></head><body><h1 id="blog-Title"><a href="index.html">&#35;import &#34;Leask.h&#34;</a></h1><div id="bp"><h2 id="bp-15BAC1A170471DB_15137-Title">&#25171;&#36896;&#33258;&#21160;&#32763;&#22681;&#30340;iPod touch or iPhone&#65281;</h2><h5 id="bp-15BAC1A170471DB_15137-publish">12/24/2009 12&#58;58&#58;14 AM</h5><div id="bp-15BAC1A170471DB_15137-content" class="blogpost"><p>最近天朝越来越“墙大”了，Twitter最后一组IP地址也已经耗尽。<br />不知道大家有没有和我一样，有在移动设备上翻墙的需要。<br />由于iPhone OS基于完整的UNIX，那么想象的空间就很大了，ssh -D直接跑在iPhone OS上已经不是什么新鲜事情，但是ssh的链接有一点脆弱，碰上网络不稳定的时候还真的挺郁闷的。<br />既然Desktop UNIX上有autossh（实现ssh断线或者无响应的时候自动重新发起连接，注意如果想实现自动身份验证，你需要上传你的公匙【方法自行Google，十分简单】。），那么是不是iPhone OS也能编译一个对应的autossh呢？打开xcode，正打算对autossh的代码开刀。突然想起上Cydia上看看，果然已经有人编译好了，于是站在巨人的肩膀上：</p> <p><img src="http&#58;//t.leaskh.com/1mwP" /></p> <p>简单编辑一下以下的脚本，并上传到设备上（注意设置权限为“可执行”）：</p> <blockquote> <p><em>#!/bin/bash<br />killall autossh;<br />killall ssh;<br />autossh -M20000 -f -q -N –D <strong>yourPort</strong> -g <strong>yourUserName@yourSSHServer</strong>;<br />echo Flora tssh [Done]; <br />exit 0;</em></p></blockquote> <p>当然了，脚本名字和提示信息等个性化的东西你随便写就可以，执行效果如下：</p> <p><img src="http&#58;//t.leaskh.com/1mwR" /></p> <p>可爱的Facebook又回来了：</p> <p><img src="http&#58;//t.leaskh.com/1mwS" /></p> <p>当然你也是可以配合pac文件用。pac文件和电脑上的语法完全一样，几乎不用做什么修改就能用到iPhone OS上了。<br />现在开始只需要启动一次脚本，就永远自动挂着ssh-D了哦，和电脑上翻墙一样方便了。</p> <p>PS 1 ：硬启动以后需要运行一次脚本哦，休眠醒来后不需要，千万不要忘记上传公匙。<br />PS 2 ：有兴趣的朋友还可以把autossh放在启动项目上。<br />PS 3 ：脚本其实不是必要的，autossh比较必要，脚本是为了让大家免去每次输入繁琐的命令。</p>  </div><h3>Comments</h3><div id="bp-15BAC1A170471DB_15137-comments" class="comments"><div id="comment-15BAC1A170471DB_15145"><h5 id="comment-15BAC1A170471DB_15145">jiang jjgod - 12/29/2009 11&#58;51&#58;29 AM</h5>你还得改代理服务器吧，没写这个步骤怎么翻。</div><div id="comment-15BAC1A170471DB_15146"><h5 id="comment-15BAC1A170471DB_15146">Leask Huang - 12/30/2009 1&#58;01&#58;32 AM</h5>看清楚啦！我写了，用pac文件，倒数第5行。jjgod看文章要认真呀。</div></div></div></body></html>