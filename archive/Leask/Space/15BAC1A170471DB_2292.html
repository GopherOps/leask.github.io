<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><link rel="stylesheet" type="text/css" href="style.css" /><title>&#27605;&#19994;&#35774;&#35745; DEMO_1 &#22320;&#22270;&#26174;&#31034;&#27169;&#22359; &#28304;&#30721;&#20998;&#20139;</title></head><body><h1 id="blog-Title"><a href="index.html">&#35;import &#34;Leask.h&#34;</a></h1><div id="bp"><h2 id="bp-15BAC1A170471DB_2292-Title">&#27605;&#19994;&#35774;&#35745; DEMO_1 &#22320;&#22270;&#26174;&#31034;&#27169;&#22359; &#28304;&#30721;&#20998;&#20139;</h2><h5 id="bp-15BAC1A170471DB_2292-publish">1/26/2008 6&#58;02&#58;57 PM</h5><div id="bp-15BAC1A170471DB_2292-content" class="blogpost"><div>'=============================================================<br />'地图显示模块 DEMO 1<br />'<br />'设计/编程&#58; 黄思夏<br />'Design/Program&#58; Leask Huang<br />'Copyfree (C) 2008 Leask Huang<br />'<br />'==============================================================</div>
<div> </div>
<div>Option Explicit<br />Dim Move_X As Long<br />Dim Move_Y As Long</div>
<div> </div>
<div>Private Sub Map_Init()<br />Map_CT_X.Top = Map_FM.Top + Map_FM.Height + 10<br />Map_CT_Y.Left = Map_FM.Left + Map_FM.Width + 10<br />Map_CT_X.Height = 280<br />Map_CT_Y.Width = 280<br />Map_CT_X.Width = Map_FM.Width<br />Map_CT_Y.Height = Map_FM.Height<br />Map_CT_X.Left = Map_FM.Left<br />Map_CT_Y.Top = Map_FM.Top<br />Map_CT_X.Min = 0<br />Map_CT_X.Max = Map_FM.Width - Map_CT.Width<br />Map_CT_Y.Min = 0<br />Map_CT_Y.Max = Map_FM.Height - Map_CT.Height<br />Map_CT.Left = 0<br />Map_CT.Top = 0<br />End Sub</div>
<div> </div>
<div>Private Sub Form_Load()<br />Map_Init<br />End Sub</div>
<div> </div>
<div>Private Sub Map_CT_MouseDown(Button As Integer, Shift As Integer, X As Single, Y As Single)<br />If Button = 1 Then<br />Move_X = X<br />Move_Y = Y<br />End If<br />End Sub</div>
<div> </div>
<div>Private Sub Map_CT_MouseMove(Button As Integer, Shift As Integer, X As Single, Y As Single)<br />If Button = 1 Then<br />Dim Move_X_Do As Long<br />Dim Move_Y_Do As Long<br />Move_X_Do = Map_CT.Left + X - Move_X<br />Move_Y_Do = Map_CT.Top + Y - Move_Y<br />If Move_X_Do &gt; 0 Then Move_X_Do = 0<br />If Move_X_Do + Map_CT.Width - Map_FM.Width &lt; 0 Then Move_X_Do = Map_FM.Width - Map_CT.Width<br />If Move_Y_Do + Map_CT.Height - Map_FM.Height &lt; 0 Then Move_Y_Do = Map_FM.Height - Map_CT.Height<br />If Move_Y_Do &gt; 0 Then Move_Y_Do = 0<br />Map_CT.Left = Move_X_Do<br />Map_CT.Top = Move_Y_Do<br />Map_CT_X.Value = Map_CT.Left<br />Map_CT_Y.Value = Map_CT.Top<br />End If<br />Label1(0).Caption = &quot;X&#58; &quot; &amp; X<br />Label1(1).Caption = &quot;Y&#58; &quot; &amp; Y<br />End Sub</div>
<div><br />Private Sub Map_CT_x_Scroll()<br />Map_CT.Left = Map_CT_X.Value<br />End Sub</div>
<div> </div>
<div>Private Sub Map_CT_Y_Scroll()<br />Map_CT.Top = Map_CT_Y.Value<br />End Sub</div></div><h3>Comments</h3><div id="bp-15BAC1A170471DB_2292-comments" class="comments"></div></div></body></html>