<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><link rel="stylesheet" type="text/css" href="style.css" /><title>Synchronizing Address Book with Google Contacts // &#20026;&#20102;&#24536;&#21364;&#30340;&#32426;&#24565;</title></head><body><h1 id="blog-Title"><a href="index.html">&#35;import &#34;Leask.h&#34;</a></h1><div id="bp"><h2 id="bp-15BAC1A170471DB_14847-Title">Synchronizing Address Book with Google Contacts // &#20026;&#20102;&#24536;&#21364;&#30340;&#32426;&#24565;</h2><h5 id="bp-15BAC1A170471DB_14847-publish">8/17/2009 1&#58;51&#58;47 PM</h5><div id="bp-15BAC1A170471DB_14847-content" class="blogpost"><p>// 以下Script的作者是Riobard Zhan，作用是能够让Apple的Address Book实现与Google Contacts实现同步，而不仅仅是当iPod touch或者iPhone连接iTunes的时候同步。<br />// 不过仅仅是在使用10.5.x的时候，你需要这个脚本，如果是10.6的话，Address  Book和Google Contacts已经能自动同步了，当然，还包括iCal和Goolge Calendar。<br />// 贴上来仅仅是为了忘却的纪念吧，使用Snow Leopard已经好几天了，不知道10A342是不是GM，也不知道GM和Retail Version会不会有差异，我只知道距离上一个版本，10A342已经把几乎所有的Bug都修正了，系统能够作为日常工作和使用的系统了。除了VMware的鼠标捕捉还有一点点不流畅。不过影响不大。<br />// 不过每次告别上一代的Mac OS，我都会伤感一下子，感叹时光又一去不返了。  <p><img style="border-bottom&#58;0px;border-left&#58;0px;display&#58;inline;border-top&#58;0px;border-right&#58;0px" title="Screen shot 2009-08-17 at 1.18.44 PM" border="0" alt="Screen shot 2009-08-17 at 1.18.44 PM" src="img/15BAC1A170471DB_14847_0.jpg" width="321" height="393" />  <p>好了，如果你还在用10.5，又和我一样，喜欢Apple和Google，那么，下面的脚本适合你：  <p>------------------------- gconsync.sh ---------------------------  <p>#!/bin/bash  <p>#############################################################################<br /># Synchronizing Address Book with Google Contacts<br />#<br /># Author&#58;  Riobard Zhan<br /># Email&#58;   me@riobard.com<br /># Web&#58;     <a href="http&#58;//riobard.com">http&#58;//riobard.com</a><br /># Version&#58; 0.1<br />#<br /># This script will modify your system to synchronize your Address Book with <br /># Google Contacts without needing an iPhone/iPod. The synchronization is done <br /># periodically in the background using `launchd`. <br />#<br /># WARNING&#58; I WILL NOT BE RESPONSABLE FOR ANY DATA LOSS OR DAMAGES CAUSED BY <br />#          THIS SCRIPT. USE AT YOUR OWN RISK!<br />#############################################################################  <p># location of the gconsync command<br />GCONSYNC=/System/Library/PrivateFrameworks/GoogleContactSync.framework/Resources/gconsync  <p># trick OS X to think there is an iPod attached  <p>echo &quot;&#123; Devices = &#123; red-herring = &#123; 'Family ID' = 10001; &#125;; &#125;; &#125;&quot;  &gt; ~/Library/Preferences/com.apple.iPod.plist  <p># enable Address Book synchronization with Google<br />echo<br />echo Now open \&quot;Address Book\&quot; and click \&quot;Preferences\&quot; in the menu. Check \&quot;Synchronize with Google\&quot; box. It will ask for your Google account and password. <br />echo<br />read -p &quot;Did you check the box and enter your Google account and password? (Yes/No)&#58; &quot; answer<br />if [[ &quot;$answer&quot; != [Yy]* ]]; then<br />    echo Bye.<br />    exit<br />fi  <p># start initial sync<br />echo<br />echo Initial synchronization started, please wait ... <br />$GCONSYNC  --sync gconclid  <p>echo Initial synchronization done. You may open Address Book and your Gmail Contacts page to check the result.  <p># enable perodic sync<br />echo<br />echo How often do you want the synchronization to happen periodically?  <p>while true; do<br />    read -p &quot;Enter a number in seconds [Default&#58; 300]&#58; &quot; INTERVAL<br />    if [[ $INTERVAL == &quot;&quot; ]]; then<br />        INTERVAL=300<br />        break<br />    elif [[ $INTERVAL =~ ^[0-9]+$ ]]; then<br />        break<br />    else<br />        echo Invalid number!<br />    fi<br />done  <p># create launchd job file<br />cd ~/Library/LaunchAgents/<br />echo &quot;&lt;?xml version=\&quot;1.0\&quot; encoding=\&quot;UTF-8\&quot;?&gt;<br />&lt;!DOCTYPE plist PUBLIC \&quot;-//Apple//DTD PLIST 1.0//EN\&quot; \&quot;<a href="http&#58;//www.apple.com/DTDs/PropertyList-1.0.dtd\&quot;">http&#58;//www.apple.com/DTDs/PropertyList-1.0.dtd\&quot;</a>&gt;<br />&lt;plist version=\&quot;1.0\&quot;&gt;<br />&lt;dict&gt;<br />    &lt;key&gt;Label&lt;/key&gt;<br />    &lt;string&gt;com.google.contacts.sync.addressbook&lt;/string&gt;<br />    &lt;key&gt;ProgramArguments&lt;/key&gt;<br />    &lt;array&gt;<br />        &lt;string&gt;$GCONSYNC&lt;/string&gt;<br />        &lt;string&gt;--sync&lt;/string&gt;<br />        &lt;string&gt;gconclid&lt;/string&gt;<br />        &lt;string&gt;--syncmode&lt;/string&gt;<br />        &lt;string&gt;fast&lt;/string&gt;<br />    &lt;/array&gt;<br />    &lt;key&gt;StartInterval&lt;/key&gt;<br />    &lt;integer&gt;$INTERVAL&lt;/integer&gt;<br />&lt;/dict&gt;<br />&lt;/plist&gt;&quot; &gt;  com.google.contacts.sync.addressbook.plist  <p># load the job<br />launchctl load com.google.contacts.sync.addressbook.plist  <p>echo Done. </p>  </div><h3>Comments</h3><div id="bp-15BAC1A170471DB_14847-comments" class="comments"></div></div></body></html>